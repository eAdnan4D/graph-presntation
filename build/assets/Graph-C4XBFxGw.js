import{j as e,r as u}from"./index-Bh4Bps6E.js";function Y({details:t,visited:s}){const{startX:i=0,startY:a=0,from:l="",to:n="",eucLen:o=0,angelDeg:f=0}=t,h={left:`${i+25}px`,top:`${a+25}px`,height:`${o}px`,transform:`rotate(${f+90}deg)`};return e.jsx("div",{id:l+n,className:`edge-graph ${s?"visited-edge":""}`,style:h})}function U(){const{edges:t,path:s,curSnapshot:i}=u.useContext(v);if(i<=1)return t==null?void 0:t.map((l,n)=>e.jsx(Y,{details:l},t[n].from+t[n].to));const a={};return s.forEach((l,n)=>{if(n>=i-1)return;const o=l+s[n+1],f=s[n+1]+l;a[o]=1,a[f]=1}),t.map((l,n)=>e.jsx(Y,{visited:a[t[n].from+t[n].to],details:l},t[n].from+t[n].to))}function T({children:t}){return e.jsx("h1",{className:"graph-empty",children:t})}function J({children:t,additionalStyle:s}){return e.jsx("h3",{style:s,className:"graph-err",children:t})}function Q({filter:t}){const{allEdges:{current:s},graph:i,setGraph:a,nodes:l,path:n,isSolving:o}=u.useContext(v);function f(c){const r=JSON.parse(JSON.stringify(i));for(let d in r)r[d]=r[d].filter(([p])=>p!=c);delete r[c],a(r)}function h(c,r,d){const p=`weight-${r},${d}`,j=`weight-${d},${r}`,m=JSON.parse(JSON.stringify(i));if(c.target.value==""){document.getElementById(p).value="",document.getElementById(j).value="",m[r]=m[r].filter(([x])=>x!=d),m[d]=m[d].filter(([x])=>x!=r),a(m);return}const g=Math.abs(+c.target.value);s[`${r},${d}`]&&s[`${d},${r}`]?(m[r]=m[r].map(([x,b])=>x==d?[x,g]:[x,b]),m[d]=m[d].map(([x,b])=>x==r?[x,g]:[x,b])):(m[r].push([d,g]),m[d].push([r,g])),document.getElementById(p).value=g,document.getElementById(j).value=g,a(m)}if(!l.length)return e.jsx(T,{children:"Add Nodes first to adjust the edges"});if(t=="")return e.jsx("div",{className:"dashboard-body",children:l.map(c=>e.jsxs("div",{className:"node-details",children:[e.jsxs("h1",{className:"title",children:["Node ",c]}),e.jsx("button",{className:"delete-node",onClick:()=>f(c),disabled:o||n.length,children:"-"}),e.jsx("ul",{className:"options",children:l.map(function(r){const d=c+","+r,p=s==null?void 0:s[d];return r!=c&&e.jsxs("li",{children:[e.jsxs("label",{htmlFor:`weight-${d}`,children:["Enter Weight For Node ",r]}),e.jsx("input",{type:"number",name:`weight-${d}`,id:`weight-${d}`,...p!=0&&{defaultValue:p},placeholder:"Leave the field empty if they aren't connected",onBlur:j=>h(j,c,r),disabled:o||n.length})]},`edge-${d}`)})})]},`node-${c}`))});if(t!=""){const c=l.filter(r=>r.startsWith(t));return e.jsx("div",{className:"dashboard-body",children:c.length?c.map(r=>e.jsxs("div",{className:"node-details",children:[e.jsxs("h1",{className:"title",children:["Node ",r]}),e.jsx("button",{className:"delete-node",onClick:()=>f(r),disabled:o||n.length,children:"-"}),e.jsx("ul",{className:"options",children:l.map(function(d){const p=r+","+d,j=s==null?void 0:s[p];return d!=r&&e.jsxs("li",{children:[e.jsxs("label",{htmlFor:`weight-${p}`,children:["Enter Weight For Node ",d]}),e.jsx("input",{type:"number",name:`weight-${p}`,id:`weight-${p}`,...j!=0&&{defaultValue:j},placeholder:"Leave the field empty if they aren't connected",onBlur:m=>h(m,r,d),disabled:o||n.length})]},`edge-${p}`)})})]},`node-${r}`)):e.jsx("div",{className:"dashboard-body",children:e.jsxs(J,{children:["There is no node starts with ",t]})})})}}function q({handleClose:t,title:s,children:i}){return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"dashboard-header",children:[e.jsx("h1",{children:s}),e.jsx("button",{className:"close-dashboard",onClick:t,children:"X"}),i]})})}function Z({onClose:t,onType:s,search:i}){const{graph:a,setGraph:l,path:n,isSolving:o}=u.useContext(v),[f,h]=u.useState(""),[c,r]=u.useState(""),d=Object.keys(a);function p(g){/\w/.test(g.target.value[g.target.value.length-1])&&h(g.target.value)}function j(){if(f.length)if(d.find(g=>g==f))r("Node name already existed");else{const g=JSON.parse(JSON.stringify(a));g[f]=[],l(g),r(""),h("")}else r("Node name can't be empty")}function m(g){if(g.key==="Enter"){j();return}}return e.jsxs(q,{handleClose:t,title:"Dashboard",children:[e.jsx("input",{disabled:!d.length,type:"text",name:"search-nodes",id:"search-nodes",placeholder:"Search for nodes by name",value:i,onChange:g=>s(g)}),e.jsxs("div",{className:"add-node",children:[n.length?e.jsx("span",{children:"Clear the path first"}):c?e.jsx("span",{children:c}):null,e.jsx("input",{type:"text",name:"add-node",id:"add-node",placeholder:"Node name to add",value:f,onChange:p,onKeyUp:m,disabled:o||n.length}),e.jsx("button",{onClick:j,disabled:o||n.length,children:"Add"})]})]})}function _(){const{setShowDashboard:t}=u.useContext(v),[s,i]=u.useState(""),a=u.useRef(null);function l(o){/\w/.test(o.target.value[o.target.value.length-1])&&i(o.target.value)}u.useEffect(()=>{a.current&&a.current.classList.add("show-dashboard")},[]);function n(){if(a.current){a.current.classList.remove("show-dashboard");const o=setTimeout(()=>{t(!t),clearTimeout(o)},1e3)}}return e.jsxs("div",{ref:a,className:"graph-dashboard",children:[e.jsx(Z,{onClose:n,onType:l,search:s}),e.jsx(Q,{filter:s})]})}function A({handleSnapshot:t,dis:s=!1}){return e.jsx("button",{className:"snapshot",onClick:t,disabled:s,children:">"})}function z({node:t,styling:s,visited:i=!1}){return e.jsx("div",{id:t,className:`node-graph ${i?"visited-node":""}`,style:s,children:e.jsx("span",{children:t})})}function ee(){const{nodesStyle:t,path:s,curSnapshot:i}=u.useContext(v);if(i==0)return t.map(function({styling:l,node:n}){return e.jsx(z,{node:n,styling:l},n)});const a={};return s.forEach((l,n)=>{n<i&&(a[l]=1)}),t.map(function({styling:l,node:n}){return e.jsx(z,{node:n,visited:a[n],styling:l},n)})}function W({handleSnapshot:t,dis:s=!1}){return e.jsx("button",{className:"snapshot",onClick:t,disabled:s,children:"<"})}function H({details:t}){const{allEdges:s,path:i}=u.useContext(v),[a,l]=t.split(",");function n(){var r;if(i.length)return;const f=document.getElementById(a),h=document.getElementById(a+l),c=document.getElementById(l);f.classList.add("visited-node"),(r=h==null?void 0:h.classList)==null||r.add("visited-edge"),c.classList.add("visited-node")}function o(){var r;if(i.length)return;const f=document.getElementById(a),h=document.getElementById(a+l),c=document.getElementById(l);f.classList.remove("visited-node"),(r=h==null?void 0:h.classList)==null||r.remove("visited-edge"),c.classList.remove("visited-node")}return e.jsxs("div",{className:"relation",onMouseEnter:n,onMouseLeave:o,children:[e.jsx("div",{className:"node-weight",children:a}),e.jsx("div",{className:"arrow"}),e.jsx("span",{className:"weight",children:s.current[t]}),e.jsx("div",{className:"node-weight",children:l})]})}function O({dis:t=!1,setSearch:s,search:i}){const{isSolving:a}=u.useContext(v);function l(n){/\w/.test(n.target.value[n.target.value.length-1])&&s(n.target.value)}return e.jsxs("div",{className:"search-nodes",children:[e.jsx("label",{htmlFor:"search-relations",children:"Search for node"}),e.jsx("input",{disabled:t||a,id:"search-relations",type:"text",name:"search-relations",value:i,onChange:l,placeholder:"Search for nodes by name"})]})}function te({node:t,dis:s,onCheck:i,val:a}){const{isSolving:l}=u.useContext(v);function n(o){o.target.checked?i(function(f){return{...f,[t]:1}}):i(function(f){const h=[];return Object.keys(f).forEach(c=>{c!=t&&h.push([c,1])}),Object.fromEntries(h)})}return e.jsxs("div",{children:[e.jsxs("label",{htmlFor:`check-${t}`,children:["Node ",t]}),e.jsx("input",{type:"checkbox",onChange:n,name:`check-${t}`,id:`check-${t}`,disabled:s||l,value:a})]})}function se({parentRef:t,wantedNodes:s,start:i}){const{solveFn:a,setPath:l,isSolving:n,setIsSolving:o,setShowSolve:f}=u.useContext(v),h=Object.keys(s);async function c(){o(!0);const r=await a();o(!1),l(r),t.current&&t.current.classList.remove("show-dashboard");const d=setTimeout(()=>{f(!1),clearTimeout(d)},1e3)}return e.jsxs("div",{className:"solve-btn-container",children:[e.jsx("button",{onClick:c,className:"solve-btn",disabled:!h.length||n,children:"Find shortest path"}),";"]})}function ne(){const{setShowSolve:t,nodes:s,path:i,isSolving:a}=u.useContext(v),[l,n]=u.useState(""),[o,f]=u.useState({}),h=u.useRef(null);u.useEffect(()=>{h.current&&h.current.classList.add("show-dashboard")},[]),u.useEffect(()=>{o[l]&&f(function(r){const d=[];return Object.keys(r).forEach(p=>{p!=l&&d.push([p,1])}),Object.fromEntries(d)})},[l]);function c(){if(h.current){h.current.classList.remove("show-dashboard");const r=setTimeout(()=>{t(!1),clearTimeout(r)},1e3)}}return e.jsxs("div",{ref:h,className:"graph-dashboard solve",children:[e.jsxs(q,{title:"Find Shortest Path",handleClose:c,children:[e.jsx("label",{htmlFor:"select-node",...i.length&&{"data-path":"Clear the path first"},children:"Select start point"}),e.jsxs("select",{value:l,onChange:r=>n(r.target.value),disabled:!s.length||a||i.length,name:"select-node",id:"select-node",children:[e.jsx("option",{value:"",disabled:!0,children:"Select node"}),s.map(r=>e.jsxs("option",{value:r,children:['The node "',r,'"']},`option-${r}`))]})]}),e.jsxs("div",{className:"dashboard-body",children:[s.length?e.jsxs("div",{className:"node-details",children:[e.jsx("h1",{className:"title",children:"Mark Wanted node to visit"}),s.map(r=>r!=l&&e.jsx(te,{node:r,val:o[r],dis:l=="",onCheck:f},`check-${r}`))]}):e.jsx(T,{children:"No nodes yet create the graph first"}),e.jsx(se,{parentRef:h,wantedNodes:o,start:l})]})]})}function ae(t,s){let i="";for(let a=t.length-1;a>=0;--a)i+=t[a];return i==s}function re(t){const s=Object.keys(t),i={};s.forEach(l=>{i[l]=1});let a=!0;return s.forEach(l=>{if(a){const n=t[l];for(let o=0;o<n.length;++o)if(!i[n[o][0]]){a=!1;break}}}),a}function le(t,s){let i=!0;return s.forEach(a=>{i&&t[a].forEach(n=>{const o=t[n[0]];if(!o){i=!1;return}let f=!0;for(let h=0;h<o.length&&o[h][0]!=a;h++)o[h][0]!=a&&h==o.length-1&&(f=!1);f||(i=!1)})}),i}function oe(t,s,i){const a=s/4-25,l=s/4-25,n=[];for(let o=0;o<i;o++){const f=o*(2*Math.PI/i),h=a+t*Math.cos(f),c=l+t*Math.sin(f);n.push({x:h,y:c})}return n}function ie(t,s){const i=Object.keys(t),a={},l=[];let n=0;return i.forEach(o=>{t[o].forEach(h=>{var j,m,g,x,b,F,G,D,w,E,C,y;const[c,r]=h,d=o+","+c,p=c+","+o;if(!a[d]||!a[p]){const k=Math.abs(((j=s[o])==null?void 0:j.x)-((m=s[c])==null?void 0:m.x))+Math.abs(((g=s[o])==null?void 0:g.y)-((x=s[c])==null?void 0:x.y)),I=((b=s[o])==null?void 0:b.x)-((F=s[c])==null?void 0:F.x),N=((G=s[o])==null?void 0:G.y)-((D=s[c])==null?void 0:D.y),$=Math.sqrt(Math.pow(I,2)+Math.pow(N,2)),P=Math.atan2(N,I),B=P*(180/Math.PI),M={startX:(w=s[o])==null?void 0:w.x,endX:(E=s[c])==null?void 0:E.x,startY:(C=s[o])==null?void 0:C.y,endY:(y=s[c])==null?void 0:y.y,from:o,to:c,manLen:k,eucLen:$,angelRad:P,angelDeg:B};l.push(M),a[d]=r,a[p]=r,n+=r}})}),{edges:l,presented:a,totalCost:n}}const v=u.createContext({graph:null,path:null,setPath:null,solveFn:null,isSolving:null,setIsSolving:null,error:null,abslouteEdges:null,allEdges:null,filter:null,setFilter:null,elementsCount:null,showDashboard:null,setShowDashboard:null,setGraph:null,showSolve:null,setShowSolve:null,points:null,nodesCoordinate:null,nodesStyle:null,nodeSize:null,lengthForSide:null,edges:null,nodes:null,curSnapshot:null,setCurSnapshot:null});function R({children:t,solveFn:s,nodeSize:i=50,lengthForSide:a=100,height:l=600}){const[n,o]=u.useState({}),[f,h]=u.useState([]),[c,r]=u.useState(!1),[d,p]=u.useState(!1),[j,m]=u.useState("graph"),[g,x]=u.useState(!1),[b,F]=u.useState(!1),[G,D]=u.useState(0),w=u.useRef(null),E=u.useRef({}),C=u.useRef(t.length),y=Object.keys(n),k=y.length,I=k*100/4,N=oe(I,a*k,k),$={},P=y.map(function(L,S){const K={left:`${N[S].x}px`,top:`${N[S].y}px`};return $[L]=N[S],{styling:K,node:L}}),{edges:B,presented:M}=ie(n,$),X=[],V=Object.keys(M);if(V.reduce(function(L,S){return ae(L,S)&&X.push(L),S},V[0]),E.current=M,u.useEffect(()=>{C.current=t.length}),u.useLayoutEffect(()=>{w.current.style.setProperty("--height-dashboard",`${l}px`)},[l]),t.length>=3&&t[0].type.name!="GraphFilter"&&t.at(-1).type.name!="GraphFilter")throw new Error("This isn't a valid layout. GroupFilter component must be either the first child or last child");if(t.length<=2&&(t[0].type.name=="GraphFilter"||t[1].type.name=="GraphFilter"))throw new Error("This isn't a valid layout. GroupFilter component must be with Presentation component and Nodelist");if(typeof t=="object"&&!Array.isArray(t))throw new Error("This isn't a valid layout. Graph component must hold at least Presentation component and Nodelist");return e.jsx(v.Provider,{value:{graph:n,setGraph:o,path:f,setPath:h,solveFn:s,isSolving:c,setIsSolving:r,error:d,setError:p,abslouteEdges:X,allEdges:E,filter:j,setFilter:m,elementsCount:C,showDashboard:g,setShowDashboard:x,showSolve:b,setShowSolve:F,points:N,nodesCoordinate:$,nodesStyle:P,nodeSize:i,lengthForSide:a,edges:B,nodes:y,curSnapshot:G,setCurSnapshot:D},children:e.jsxs("div",{ref:w,className:"dashboard",children:[t[0],g&&e.jsx(_,{}),b&&e.jsx(ne,{}),t.slice(1)]})})}function ce(){const{graph:t,error:s,elementsCount:i,nodeSize:a,lengthForSide:l,filter:n,setError:o,nodes:f,curSnapshot:h,setCurSnapshot:c,path:r}=u.useContext(v),d=u.useRef(null),p=f.length,j=Object.values(t).reduce((x,b)=>x+=b.length,0),m=re(t),g=le(t,f);return u.useLayoutEffect(()=>{j>p*(p-1)?o("Maximum edges mustn't exceed n * (n-1)"):o(m?g?"":"The graph either direct or there is a lack of nodes (there is a node connected to undefined node)":"There is a missing node")},[j,p,g]),u.useEffect(()=>{d.current&&(d.current.style.setProperty("--node-size",`${a}px`),d.current.style.setProperty("--nodes-count",p),d.current.style.setProperty("--length-for-node",`${l}px`))}),s?e.jsxs("div",{className:"graph-all",children:[e.jsx("div",{className:"graph-container","data-count":i.current,children:e.jsx(J,{children:s})}),e.jsxs("div",{className:"graph-pagination",children:[e.jsx(W,{dis:!0}),e.jsxs("span",{children:["Snapshot ",h+1]}),e.jsx(A,{dis:!0})]})]}):p?e.jsxs("div",{className:"graph-all",children:[e.jsx("div",{ref:d,className:"graph-container","data-count":i.current,children:e.jsxs("div",{className:"nodes-container",children:[e.jsx(ee,{}),n=="graph"&&e.jsx(U,{})]})}),e.jsxs("div",{className:"graph-pagination",children:[e.jsx(W,{dis:h==0,handleSnapshot:()=>c(x=>x-1)}),e.jsxs("span",{children:["Snapshot ",h+1," / ",r.length+1]}),e.jsx(A,{dis:h==r.length,handleSnapshot:()=>c(x=>x+1)})]})]}):e.jsxs("div",{className:"graph-all",children:[e.jsx("div",{ref:d,className:"graph-container","data-count":i.current,children:e.jsx(T,{children:"No graph yet"})}),e.jsxs("div",{className:"graph-pagination",children:[e.jsx(W,{dis:!0}),e.jsxs("span",{children:["Snapshot ",h+1]}),e.jsx(A,{dis:!0})]})]})}function he(){const[t,s]=u.useState(""),{abslouteEdges:i,elementsCount:a}=u.useContext(v);let l=t!=""?i.filter(n=>n.startsWith(t)?n:""):[];return i.length?t==""&&i.length?e.jsxs("div",{className:"weights","data-count":a.current,children:[e.jsx(O,{search:t,setSearch:s}),i.map(n=>e.jsx(H,{details:n},n))]}):t!=""&&l.length?e.jsxs("div",{className:"weights","data-count":a.current,children:[e.jsx(O,{search:t,setSearch:s}),l.map(n=>e.jsx(H,{details:n},n))]}):e.jsxs("div",{className:"weights","data-count":a.current,children:[e.jsx(O,{search:t,setSearch:s}),t!=""&&l.length==0&&e.jsxs(J,{additionalStyle:{width:"80%",margin:"1rem auto 0"},children:["There is no node starts with ",t]})]}):e.jsxs("div",{className:"weights","data-count":a.current,children:[e.jsx(O,{search:t,setSearch:s,dis:!0}),e.jsx(T,{children:"No edges yet"})]})}function de(){const{filter:t,setFilter:s,elementsCount:i}=u.useContext(v);function a(l){l.target.className.includes("graph-btn")&&(l.target.className.includes("active")||(t=="graph"?s("nodes"):t=="nodes"&&s("graph")))}return e.jsxs("div",{className:"graph-filter","data-count":i.current,onClick:a,children:[e.jsx("button",{className:`graph-btn ${t=="graph"?"active":""}`,children:"Graph"}),e.jsx("button",{className:`graph-btn ${t=="nodes"?"active":""}`,children:"Nodes"})]})}function ue(){const{graph:t,showDashboard:s,setShowDashboard:i,path:a,setPath:l,showSolve:n,setShowSolve:o,setCurSnapshot:f}=u.useContext(v);function h(){s||i(!0)}function c(){n||o(!0)}function r(){a.length&&(l([]),f(0))}return e.jsxs("div",{className:"mutate-graph",children:[e.jsx("button",{onClick:h,disabled:s||n,children:Object.keys(t).length?"Modify graph":"Create graph"}),e.jsx("button",{className:"traversal-btn",onClick:c,disabled:s||n,children:"Traversal"}),e.jsx("button",{className:"clear-btn",onClick:r,disabled:s||!a.length,children:"Clear path"})]})}R.Presentation=ce;R.NodesList=he;R.GraphFilter=de;R.MutateGraph=ue;export{v as Context,R as default};
